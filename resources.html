<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ThriveHub · Calm Space</title>
  <style>
    :root{ --brand:#0E7C86; --accent:#673AB7; --bg:#0b1220; --surface:#0f172a; --text:#e5e7eb; --muted:#9ca3af; }
    @media (prefers-color-scheme: light){
      :root{ --bg:#f7fafc; --surface:#ffffff; --text:#1f2937; --muted:#64748b; }
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.55 system-ui,-apple-system,Segoe UI,Inter,Roboto,Helvetica,Arial}
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    header{position:sticky;top:0;z-index:10;background:rgba(15,23,42,.7);backdrop-filter:saturate(120%) blur(8px);border-bottom:1px solid rgba(255,255,255,.06)}
    @media (prefers-color-scheme: light){header{background:rgba(255,255,255,.7);border-color:rgba(0,0,0,.06)}}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:10px;color:var(--brand);font-weight:800}
    .brand svg{width:30px;height:30px}
    .links a{margin:0 8px;padding:8px 12px;border-radius:10px;color:var(--text)}
    .links a.active{background:var(--brand);color:white}
    .tile{background:var(--surface);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:18px;margin:14px 0}
    @media (prefers-color-scheme: light){.tile{border-color:rgba(0,0,0,.06)}}
    h1{margin:10px 0 4px}
    .btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer;color:#031018;background:linear-gradient(180deg,#7edbff,#21b8d6);box-shadow:0 6px 16px rgba(0,0,0,.25)}
    .btn.secondary{color:white;background:linear-gradient(180deg,#7b5ae4,#6d38d9)}
    .row{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <!-- inline logo -->
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs><linearGradient id="lg" x1="0" x2="1"><stop stop-color="var(--brand)"/><stop offset="1" stop-color="var(--accent)"/></linearGradient></defs>
          <rect rx="12" ry="12" width="64" height="64" fill="url(#lg)"/>
          <path d="M16 22h32v6H34v22h-6V28H16z" fill="#fff" opacity=".95"/>
          <path d="M40 28h8v16c0 4.4-3.6 8-8 8h-6v-6h6c1.1 0 2-.9 2-2V28z" fill="#fff" opacity=".9"/>
        </svg>
        <span>ThriveHub</span>
      </div>
      <nav class="links" aria-label="Primary">
        <a href="index.html">Home</a>
        <a href="library.html">Library</a>
        <a class="active" href="resources.html" aria-current="page">Calm Space</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <h1>Calm Space</h1>
    <p style="color:var(--muted)">One-click breathing, focus and ambient sound. All tools run in the browser—no logins, no ads.</p>

    <div class="row">
      <article class="tile">
        <h2>Breathing Guide</h2>
        <p>Box-breathing animation to reset.</p>
        <button class="btn" data-open="breathing">Open Breathing</button>
        <div id="breathing-panel" hidden>
          <div id="breathing-box" aria-live="polite">Inhale…</div>
        </div>
      </article>

      <article class="tile">
        <h2>Focus Timer</h2>
        <p>25/5 Pomodoro in a new tab.</p>
        <a class="btn secondary" href="https://pomofocus.io/" target="_blank" rel="noopener">Open Timer</a>
      </article>

      <article class="tile">
        <h2>Nature Sound</h2>
        <p>Soft brown noise (plays after a click).</p>
        <button class="btn" data-audio="brown-noise" aria-pressed="false">Play Brown Noise</button>
        <label class="sr-only" for="noise-volume">Volume</label>
        <input id="noise-volume" type="range" min="0" max="1" step="0.01" value="0.25"/>
      </article>

      <article class="tile">
        <h2>Fullscreen Calm</h2>
        <p>Dimmed gradient—click or press Esc to exit.</p>
        <button class="btn" data-open="fullscreen">Enter Fullscreen</button>
      </article>
    </div>
  </main>

  <script>
  // ——— Calm Space controller (no dependencies) ———
  (() => {
    const $ = (sel, el = document) => el.querySelector(sel);
    // 1) Breathing
    let breathingTimer=null;
    const steps = [
      { label:'Inhale', seconds:4 },
      { label:'Hold',  seconds:4 },
      { label:'Exhale',seconds:4 },
      { label:'Hold',  seconds:4 },
    ];
    function startBreathing(){
      const panel = $('#breathing-panel'); if(!panel) return;
      panel.hidden = false;
      const box = $('#breathing-box', panel) || panel;
      box.textContent = `${steps[0].label}…`;
      clearInterval(breathingTimer);
      breathingTimer = setInterval(()=>{
        const i = steps.findIndex(s => box.textContent.startsWith(s.label));
        const next = steps[(i+1+steps.length)%steps.length];
        box.textContent = `${next.label}…`;
      }, steps[0].seconds*1000);
      // simple animation
      box.style.cssText = `
        width:200px;height:200px;margin:18px auto;border-radius:16px;
        display:grid;place-items:center;color:var(--text);
        background:rgba(103,58,183,.12);animation:breathe 4s ease-in-out infinite;
      `;
      if(!document.getElementById('breathe-style')){
        const style=document.createElement('style'); style.id='breathe-style';
        style.textContent='@keyframes breathe{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}';
        document.head.appendChild(style);
      }
    }

    // 2) Brown noise (starts only after a click -> allowed by autoplay policy)
    let audioCtx=null, noiseNode=null, gainNode=null;
    function toggleBrownNoise(btn, volumeInput){
      if(!audioCtx){
        audioCtx = new (window.AudioContext||window.webkitAudioContext)();
        const bufferSize = 2 * audioCtx.sampleRate;
        const brown = audioCtx.createScriptProcessor(bufferSize,1,1);
        let lastOut=0.0;
        brown.onaudioprocess = e => {
          const out=e.outputBuffer.getChannelData(0);
          for(let i=0;i<bufferSize;i++){
            const white=Math.random()*2-1;
            out[i]=(lastOut+(0.02*white))/1.02; lastOut=out[i]; out[i]*=3.5;
          }
        };
        gainNode = audioCtx.createGain();
        gainNode.gain.value = Number(volumeInput?.value || 0.25);
        brown.connect(gainNode).connect(audioCtx.destination);
        noiseNode = brown;
      }
      if(audioCtx.state==='suspended') audioCtx.resume();
      const isPlaying = btn.getAttribute('aria-pressed')==='true';
      if(isPlaying){
        audioCtx.suspend();
        btn.setAttribute('aria-pressed','false'); btn.textContent='Play Brown Noise';
      }else{
        audioCtx.resume();
        btn.setAttribute('aria-pressed','true'); btn.textContent='Pause Brown Noise';
      }
    }

    // 3) Fullscreen panel
    let fsPanel=null;
    function ensureFsPanel(){
      if(!fsPanel){
        fsPanel = document.createElement('div');
        fsPanel.id='calm-fullscreen';
        fsPanel.style.cssText = `
          position:fixed;inset:0;z-index:9999;display:none;
          background: radial-gradient(1200px 700px at 30% 20%, rgba(14,124,134,.18), transparent),
                      linear-gradient(135deg, var(--brand), var(--accent));
        `;
        fsPanel.addEventListener('click', exitFullscreen);
        document.body.appendChild(fsPanel);
      }
      return fsPanel;
    }
    function enterFullscreen(){
      const panel = ensureFsPanel(); panel.style.display='block';
      const el=document.documentElement;
      (el.requestFullscreen||el.webkitRequestFullscreen||el.msRequestFullscreen)?.call(el);
    }
    function exitFullscreen(){
      const panel = ensureFsPanel(); panel.style.display='none';
      (document.exitFullscreen||document.webkitExitFullscreen||document.msExitFullscreen)?.call(document);
    }

    // 4) Events (delegated)
    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-open],[data-audio]'); if(!btn) return;
      if(btn.hasAttribute('data-open')){
        const t=btn.getAttribute('data-open');
        if(t==='breathing') startBreathing();
        if(t==='fullscreen') enterFullscreen();
      }
      if(btn.hasAttribute('data-audio')){
        if(btn.getAttribute('data-audio')==='brown-noise'){
          toggleBrownNoise(btn, document.getElementById('noise-volume'));
        }
      }
    });
    document.addEventListener('input', (e)=>{
      if(e.target?.id==='noise-volume' && gainNode){ gainNode.gain.value = Number(e.target.value); }
    });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') exitFullscreen(); });
  })();
  </script>
</body>
</html>